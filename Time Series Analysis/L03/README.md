# **时间序列分析 - 第三章 平稳时间序列**

## **1. 平稳时间序列的定义**

### **1.1 什么是平稳时间序列？**
在时间序列分析中，我们特别关注**统计性质不会随时间变化的序列**，即**平稳时间序列 (Stationary Time Series)**。这样，我们可以使用过去的数据来推测未来的行为。

一般来说，如果一个时间序列的**统计特性（如均值、方差和自相关）不随时间变化**，则称其为**平稳时间序列**。

### **1.2 形式化定义**
一个时间序列  $\( \{X_t, t = 0, \pm1, \pm2, \dots\} \)$ **如果它的统计性质与时间无关**，那么它就是平稳的。可以用数学语言表示如下：

#### **定义 1：期望（Expectation Function）**
时间序列 $\( X_t \)$ 的期望（均值）函数定义为：
$$
\mu(t) = E[X_t], \quad t \in T
$$
其中：
-  $\( E[X_t] \)$ 代表期望，即数据的平均值。
-  $\( t \)$ 是时间索引。

#### **定义 2：协方差函数（Covariance Function）**
时间序列 \( X_t \) 的协方差函数定义为：
$$
\gamma(t, s) = \text{cov}(X_t, X_s) = E[(X_t - \mu(X_t))(X_s - \mu(X_s))]
$$
其中：
-  $\( \gamma(t, s) \)$ 代表两个不同时间点  $\( t \)$ 和  $\( s \)$ 之间的协方差，反映了它们的相关性。
-  $\( \mu(X_t) \)$ 是时间点  $\( t \)$ 处的均值。

#### **定义 3：方差函数（Variance Function）**
时间序列 $\( X_t \)$ 的方差定义为：
$$
\sigma^2_X(t) = \gamma(t, t) = \text{Var}(X_t)
$$
其中：
-  $\( \sigma^2_X(t) \)$ 是时间点  $\( t \)$ 处的方差，描述数据的离散程度。

---

## **2. 强平稳与弱平稳**

### **2.1 强平稳（Strict Stationarity）**
如果对于任意  $\( n \in \mathbb{Z}^+ \)$ 和所有整数  $\( h \)$，两个时间序列  $\( (X_1, ..., X_n) \)$ 和  $\( (X_{1+h}, ..., X_{n+h}) \)$ 具有**相同的联合分布**，那么该时间序列是**强平稳 (Strictly Stationary)**。

**直观理解**：
- 任何时间点的分布**完全一样**，不受时间影响。
- 适用于所有概率分布，不仅仅是均值和方差。

### **2.2 弱平稳（Weak Stationarity）**
如果时间序列满足以下两个条件，则称其为**弱平稳（Weakly Stationary）**：
1. **均值是常数**：
    $$ \mu_t = E[X_t] = \mu, \quad \text$$
   1. {与时间无关} 

2. **协方差仅取决于时间差 \( k \)，而与具体的时间点 \( t \) 无关**：
    $$ \gamma(t, k) = \gamma(k) $$

### **2.3 强平稳与弱平稳的关系**
- **强平稳一定是弱平稳**，因为强平稳保证了所有统计特性不变。
- **弱平稳不一定是强平稳**，因为弱平稳只考虑**均值和协方差**，而不涉及更高阶的分布特性。

**特殊情况**：当时间序列是**正态分布 (Gaussian Process)** 时，强平稳和弱平稳是等价的。

---

## **3. 自协方差与自相关函数**

### **3.1 自协方差函数 (Autocovariance Function)**
对于平稳时间序列，我们通常使用**时间滞后 \( k \) 的协方差**：
$$
\gamma_k = \text{cov}(X_t, X_{t+k}) = E[(X_t - \mu)(X_{t+k} - \mu)]
$$
其中：
-  $\( \gamma_k \)$ 仅依赖于时间差  $\( k \)$，而不是具体的时间点  $\( t \)$。

### **3.2 自相关函数 (Autocorrelation Function, ACF)**
自相关函数用于度量时间序列不同时间点之间的相关性：
$$
\rho_k = \frac{\gamma_k}{\gamma_0}
$$
其中：
-  $\( \gamma_0 \)$ 是方差  $\( \sigma^2 \)$，用于标准化协方差，使  $\( \rho_k \)$ 的取值范围在  $\([-1, 1]\)$ 之间。

### **3.3 自相关函数的性质**
-  $\( \rho_0 = 1 \)$（因为与自身完全相关）。
-  $\( \rho_k = \rho_{-k} \)$（对称性）。
- 当  $\( k \)$ 增加时， $\( \rho_k \)$ 通常逐渐衰减。

---

## **4. 移动平均模型 (Moving Average Model, MA)**
**移动平均模型 (MA) 是对时间序列建模的一种方式，其中当前值是过去误差项的线性组合**。

### **4.1 一阶移动平均模型 (MA(1))**
$$
X_t = Z_t + \theta Z_{t-1}
$$
其中：
-  $\( Z_t \sim WN(0, \sigma^2) \)$ 是**白噪声**，即无相关的随机变量。
-  $\( \theta \)$ 是模型参数，决定了时间序列的依赖性。

### **4.2 q 阶移动平均模型 (MA(q))**
$$
X_t = Z_t + \sum_{j=1}^{q} \theta_j Z_{t-j}
$$
其中：
-  $\( \theta_j \)$ 表示滞后  $\( j \)$ 的噪声对当前值的影响。
- **特点**：MA(q) 过程的"自相关函数在滞后  $\( q \)$ 之后截断为零"。

---

## **5. 自回归模型 (Autoregressive Model, AR)**
自回归模型 (AR) 假设当前值  $\( X_t \)$ 由过去的  $\( p \)$ 个值线性决定：
$$
X_t = \sum_{i=1}^{p} \phi_i X_{t-i} + Z_t
$$
其中：
-  $\( \phi_i \)$ 是**回归系数**，决定了过去值对当前值的影响。
- **特点**：AR(p) 过程的**自相关函数呈指数衰减**。

---

## **6. ARMA 和 ARIMA 模型**
### **6.1 ARMA 模型**
ARMA 结合了 **AR(p)** 和 **MA(q)**：
$$
X_t - \sum_{i=1}^{p} \phi_i X_{t-i} = Z_t + \sum_{j=1}^{q} \theta_j Z_{t-j}
$$
适用于**平稳时间序列**。

### **6.2 ARIMA 模型**
如果时间序列是**非平稳的**，我们可以使用 **差分运算** \( \nabla^d X_t \) 使其平稳：
$$
(1 - B)^d X_t = ARMA(p, q)
$$
其中 \( B \) 是**滞后算子**。

---

## **总结**
- **平稳性是时间序列建模的重要基础**。
- **自相关函数和自协方差函数用于分析序列的相关性**。
- **AR、MA、ARMA 和 ARIMA 是最常用的时间序列模型**。

---

